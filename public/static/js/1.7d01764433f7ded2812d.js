webpackJsonp([1],{"3cXf":function(t,e,a){t.exports={default:a("L+o2"),__esModule:!0}},CCwu:function(t,e){},"L+o2":function(t,e,a){var i=a("ZuHZ"),n=i.JSON||(i.JSON={stringify:JSON.stringify});t.exports=function(t){return n.stringify.apply(n,arguments)}},"am/r":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("4YfN"),n=a.n(i),l=a("3cXf"),r=a.n(l),o=a("aA9S"),s=a.n(o),c=a("a3Yh"),u=a.n(c),g=a("PSPz"),p=a("HjG9"),d=a("9Vkk"),m=a("rVsN"),h=a.n(m),v=a("T452"),f=a("xjP8"),x=a("vLgD"),y={headers:{"Content-Type":"multipart/form-data"}};function b(t){return new h.a(function(e,a){x.a.post(f.a+v.a,t,y).then(function(t){console.log(t),e(t)}).catch(function(t){a(t),console.log(t)})})}var w=a("xT6B");let _;const D=(t,e)=>{"ie"==(()=>{let t=window.navigator.userAgent;return t.indexOf("MSIE")>=0?"ie":t.indexOf("Firefox")>=0?"Firefox":t.indexOf("Chrome")>=0?"Chrome":t.indexOf("Opera")>=0?"Opera":t.indexOf("Safari")>=0?"Safari":void 0})()?k(t,e):S(t,e)},k=(t,e)=>{let a=t,i=new ActiveXObject("Excel.Application"),n=i.Workbooks.Add(),l=n.Worksheets(1),r=document.body.createTextRange();r.moveToElementText(a),r.select,r.execCommand("Copy"),l.Paste(),i.Visible=!0;try{let t=i.Application.GetSaveAsFilename("Excel.xls","Excel Spreadsheets (*.xls), *.xls")}catch(t){print("Nested catch caught "+t)}finally{n.SaveAs(t),n.Close(savechanges=!1),i.Quit(),i=null,window.setInterval("Cleanup();",1),_=window.setInterval("Cleanup();",1)}},S=(t,e)=>{const a="data:application/vnd.ms-excel;base64,"+(C=((t,e)=>t.replace(/{(\w+)}/g,(t,a)=>e[a]))('<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta charset="UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body><table>{table}</table></body></html>',{worksheet:e,table:t}),window.btoa(unescape(encodeURIComponent(C))));if(navigator.userAgent.indexOf("Firefox")>-1)window.location.href=a;else{const t=document.createElement("a");let i;t.href=a,t.download=e||"",window.MouseEvent?i=new MouseEvent("click"):(i=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),t.dispatchEvent(i)}};var C;var E=(t,e,a)=>{const i={image:function(t,e){return`<td style="width: ${(e=Object.assign({width:40,height:60},e)).width}px; height: ${e.height}px; text-align: center; vertical-align: middle"><img src="${t}" width=${e.width} height=${e.height}></td>`},text:function(t){return`<td style="text-align: center">${t}</td>`}};let n=t.reduce((t,e)=>t+=`<th>${e.title}</th>`,"");n=`<thead><tr>${n}</tr></thead>`;let l=e.reduce((e,a)=>e+=`<tr>${t.reduce((t,e)=>t+=i[e.type||"text"](a[e.key],e),"")}</tr>`,"");D(n+(l=`<tbody>${l}</tbody>`),a)},T=a("fUgm"),$=(a("b9Z+"),{data:function(){var t;return t={imgUrl1:"",imgUrl2:"",imgUrl3:"",dialogVisible:!1,training:{title:"",status:"waiting",machineNum:"",summarize:"",imgStart:"1.png",imgStartDes:"",imgDoing:"1.png",imgDoingDes:"",imgEnd:"1.png",imgEndDes:"",trainUser:"",completionTime:"",guider:""},valueDate:"",value:""},u()(t,"dialogVisible",!1),u()(t,"coverVal",""),u()(t,"statusOptions",[{label:"waiting",value:"waiting"},{label:"doing",value:"doing"},{label:"completion",value:"completion"}]),u()(t,"coverOptions",[{label:"可Cover",value:"normalleave"},{label:"不可Cover",value:"errorleave"}]),u()(t,"pictLoading",!1),u()(t,"tableData",[]),u()(t,"currentPage",1),u()(t,"pageSize",10),u()(t,"userNum",""),u()(t,"startDate",""),u()(t,"total",0),u()(t,"endDate",""),u()(t,"pickerOptionsStart",{disabledDate:function(t){return t?t.getTime()>Date.now():""}}),u()(t,"pickerOptionsEnd",{disabledDate:function(t){return t?t.getTime()>Date.now():""}}),t},methods:{handleClick:function(t){var e,a=this,i=t._id;(e={_id:i,createUser:this.userInfo.username},new h.a(function(t,a){x.a.post(f.a+v.c,e).then(function(e){console.log(e),t(e)}).catch(function(t){a(t),console.log(t)})})).then(function(t){"error"===t.data?a.$message({message:"删除失败!",type:"warning"}):"ok"===t.data?(a.$message({message:"删除成功!",type:"success"}),a._search()):a.$message({message:"未知错误请联系管理员!",type:"error"})})},uploadIssueInfo:function(){var t,e=this;this.isLogin?(t=s()({},this.training,{createUser:this.userInfo.username}),new h.a(function(e,a){x.a.post(f.a+v.b,t).then(function(t){console.log(t),e(t)}).catch(function(t){a(t),console.log(t)})})).then(function(t){t.data?"no_exist"===t.data?e.$message({message:"用户名不存在",type:"warning"}):(e.$message({message:"上傳成功!",type:"success"}),e.dialogVisible=!1,e._search()):(e.$message({message:"token过期，请重新登录",type:"warning"}),e.dialogVisible=!1)}).catch(function(t){console.log(t)}):this.$message({message:"请登录",type:"warning"})},cutDown:function(t){var e=new FormData;e.append("image",t.blob);var a=this;b(e).then(function(t){a.training.imgStart=t.data.url}),this.imgUrl1=t.dataURL},cutDown1:function(t){var e=new FormData;e.append("image",t.blob);var a=this;b(e).then(function(t){a.training.imgDoing=t.data.url}),this.imgUrl2=t.dataURL},cutDown2:function(t){var e=new FormData;e.append("image",t.blob);var a=this;b(e).then(function(t){a.training.imgEnd=t.data.url}),this.imgUrl3=t.dataURL},_addItem:function(){this.dialogVisible=!0},changeStart:function(){if(""!==this.startDate&&null!==this.startDate){var t=this;this.pickerOptionsEnd={disabledDate:function(e){if(""!==t.startDate&&null!==t.startDate)return e.getTime()>t.startDate.getTime()+1296e7||e.getTime()<t.startDate.getTime()}}}else this.endDate=""},_search:function(){var t,e,a,i=this;this.pictLoading=!0,(t=this.pageSize,e=this.currentPage,a=r()(this.valueDate),new h.a(function(i,n){x.a.get(f.a+v.e+"?limit="+t+"&skip="+(e-1)*t+"&dateArray="+a).then(function(t){i(t)}).catch(function(t){n(t),console.log(t)})})).then(function(t){console.log(t),t.data.data.forEach(function(t){t.completionTime=Object(w.a)(t.completionTime),t.createTime=Object(w.a)(t.createTime)}),i.tableData=t.data.data,console.log(t.data),i.total=t.data.total,i.pictLoading=!1})},_exportExcel:function(){var t,e=this;(t=r()(this.valueDate),new h.a(function(e,a){x.a.get(f.a+v.d+"?dateArray="+t).then(function(t){e(t)}).catch(function(t){a(t),console.log(t)})})).then(function(t){t.data.data.forEach(function(t){t.createTime=Object(w.a)(t.createTime),t.completionTime=Object(w.a)(t.completionTime)});var a=e.valueDate.length>1?"培訓完成表 "+e.valueDate[0].substring(0,10)+"-"+e.valueDate[1].substring(0,10):"培訓完成表";e.tableData.length?E([{title:"項目",key:"title",type:"text"},{title:"完成狀態",key:"status",type:"text"},{title:"機種",key:"machineNum",type:"text"},{title:"概要",key:"summarize",type:"text"},{title:"初始圖",key:"imgStart",type:"image",width:200,height:200},{title:"初始圖說明",key:"imgStartDes",type:"text"},{title:"過程圖",key:"imgDoing",type:"image",width:200,height:200},{title:"過程圖說明",key:"imgDoingDes",type:"text"},{title:"結果圖",key:"imgEnd",type:"image",width:200,height:200},{title:"結果圖說明",key:"imgEndDes",type:"text"},{title:"受訓人",key:"trainUser",type:"text"},{title:"完成時間",key:"completionTime",type:"text"},{title:"導師",key:"guider",type:"text"},{title:"創建時間",key:"createTime",type:"text"}],t.data.data,a):e.$message({message:"Please select at least one item",type:"warning"})})},handleSizeChange:function(t){this.currentPage=1,this.pageSize=t,this._search()},handleCurrentChange:function(t){this.currentPage=t,this._search()}},mounted:function(){this._search()},computed:n()({},Object(T.d)({isLogin:function(t){return t.isLogin}}),Object(T.b)(["userInfo"])),components:{BasePagination:g.a,DataTable:p.a,ImgCutter:d.a}}),O={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticStyle:{display:"flex","justify-content":"space-between","margin-bottom":"10px"}},[a("div",{staticStyle:{display:"flex"}},[a("span",{staticClass:"title",staticStyle:{"margin-left":"20px"}},[t._v("日期 :")]),t._v(" "),a("el-date-picker",{attrs:{type:"daterange","range-separator":"至",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd 00:mm:ss","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.valueDate,callback:function(e){t.valueDate=e},expression:"valueDate"}})],1),t._v(" "),a("div",[a("el-button",{staticClass:"exportExcel",staticStyle:{"margin-right":"20px","text-align":"right",background:"#77A1D3"},attrs:{type:"primary",icon:"el-icon-download"},on:{click:t._exportExcel}},[t._v("導出Excel")]),t._v(" "),a("el-button",{staticClass:"exportExcel",staticStyle:{"margin-right":"20px","text-align":"right",background:"#20BDFF"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t._addItem}},[t._v("新增issue")]),t._v(" "),a("el-button",{staticStyle:{background:"#3CA55C"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:t._search}},[t._v("搜索")])],1)]),t._v(" "),t.tableData.length?a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.pictLoading,expression:"pictLoading"}],staticStyle:{width:"100%"},attrs:{"element-loading-background":"rgba(0, 0, 0, 0.5)","element-loading-text":"数据正在加载中","element-loading-spinner":"el-icon-loading",stripe:!0,border:!0,data:t.tableData,"highlight-current-row":""}},[a("el-table-column",{attrs:{type:"index",label:"序號",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",property:"title",width:"100px",label:"課題"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",property:"status",label:"狀態"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",property:"machineNum",label:"機種"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",property:"summarize",width:"100px",label:"概要"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",property:"imgStart",label:"初始圖"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("el-image",{attrs:{"min-width":"100",height:"100",src:t.row.imgStart,"preview-src-list":[t.row.imgStart]}})]}}],null,!1,3593107788)}),t._v(" "),a("el-table-column",{attrs:{align:"center",width:"100px",property:"imgStartDes",label:"初始圖說明"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",property:"imgDoing",label:"過程圖"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("el-image",{attrs:{"min-width":"100",height:"100",src:t.row.imgDoing,"preview-src-list":[t.row.imgDoing]}})]}}],null,!1,1041596140)}),t._v(" "),a("el-table-column",{attrs:{align:"center",width:"100px",property:"imgDoingDes",label:"過程圖說明"}}),t._v(" "),a("el-table-column",{attrs:{property:"imgEnd",label:"完成圖"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("el-image",{attrs:{"min-width":"100",height:"100",src:t.row.imgEnd,"preview-src-list":[t.row.imgEnd]}})]}}],null,!1,4186374444)}),t._v(" "),a("el-table-column",{attrs:{width:"100px",property:"imgEndDes",label:"完成圖說明"}}),t._v(" "),a("el-table-column",{attrs:{property:"trainUser",label:"受訓人"}}),t._v(" "),a("el-table-column",{attrs:{width:"100px",property:"completionTime",label:"完成時間"}}),t._v(" "),a("el-table-column",{attrs:{property:"guider",label:"導師"}}),t._v(" "),a("el-table-column",{attrs:{property:"createUser",label:"上傳人員"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",width:"100px",property:"createTime",label:"創建時間"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popconfirm",{directives:[{name:"show",rawName:"v-show",value:t.userInfo.username===e.row.username||"root"===t.userInfo.username,expression:"userInfo.username === scope.row.username || userInfo.username === 'root'"}],attrs:{title:"这是一段内容确定删除吗？"},on:{confirm:function(a){return t.handleClick(e.row)}}},[a("el-button",{attrs:{slot:"reference",type:"text",size:"small"},slot:"reference"},[t._v("删除")])],1)]}}],null,!1,4215950496)})],1):t._e(),t._v(" "),t.tableData.length?a("BasePagination",{attrs:{total:t.total},on:{handleCurrentChange:t.handleCurrentChange,handleSizeChange:t.handleSizeChange}}):t._e(),t._v(" "),a("el-dialog",{attrs:{title:"training詳情表","close-on-click-modal":!1,visible:t.dialogVisible,width:"1200px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{staticStyle:{display:"flex","justify-content":"space-around"}},[a("div",[a("div",{staticStyle:{"margin-top":"10px"}},[a("span",{staticClass:"title"},[t._v("標題:")]),a("el-input",{staticStyle:{width:"220px"},model:{value:t.training.title,callback:function(e){t.$set(t.training,"title",e)},expression:"training.title"}})],1),t._v(" "),a("div",{staticStyle:{"margin-top":"10px"}},[a("span",{staticClass:"title"},[t._v("狀態:")]),a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.training.status,callback:function(e){t.$set(t.training,"status",e)},expression:"training.status"}},t._l(t.statusOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("div",{staticStyle:{"margin-top":"10px"}},[a("span",{staticClass:"title"},[t._v("機種:")]),a("el-input",{staticStyle:{width:"220px"},model:{value:t.training.machineNum,callback:function(e){t.$set(t.training,"machineNum",e)},expression:"training.machineNum"}})],1),t._v(" "),a("div",{staticStyle:{"margin-top":"10px"}},[a("span",{staticClass:"title"},[t._v("概要:")]),a("el-input",{staticStyle:{width:"220px"},model:{value:t.training.summarize,callback:function(e){t.$set(t.training,"summarize",e)},expression:"training.summarize"}})],1),t._v(" "),a("div",{staticStyle:{display:"flex","margin-top":"10px"}},[a("span",{staticClass:"title"},[t._v("受訓人:")]),a("el-input",{staticStyle:{width:"220px"},model:{value:t.training.trainUser,callback:function(e){t.$set(t.training,"trainUser",e)},expression:"training.trainUser"}})],1),t._v(" "),a("div",{staticStyle:{display:"flex","margin-top":"10px"}},[a("span",{staticClass:"title"},[t._v("導師:")]),a("el-input",{staticStyle:{width:"220px"},model:{value:t.training.guider,callback:function(e){t.$set(t.training,"guider",e)},expression:"training.guider"}})],1),t._v(" "),a("div",{staticStyle:{display:"flex","margin-top":"10px"}},[a("span",{staticClass:"title"},[t._v("完成時間 :")]),a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:t.training.completionTime,callback:function(e){t.$set(t.training,"completionTime",e)},expression:"training.completionTime"}})],1)]),t._v(" "),a("div",[a("div",{staticStyle:{"margin-top":"10px","text-align":"center"}},[a("ImgCutter",{attrs:{rate:"1:1",label:"點擊上傳初始圖"},on:{cutDown:t.cutDown}}),t._v(" "),a("img",{staticStyle:{"margin-top":"20px"},attrs:{src:t.imgUrl1,width:"200px",height:"200px",alt:"選擇初始圖"}}),t._v(" "),a("div",{staticStyle:{"margin-top":"10px"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"初始圖說明"},model:{value:t.training.imgStartDes,callback:function(e){t.$set(t.training,"imgStartDes",e)},expression:"training.imgStartDes"}})],1)],1)]),t._v(" "),a("div",[a("div",{staticStyle:{"margin-top":"10px","text-align":"center"}},[a("ImgCutter",{attrs:{rate:"1:1",label:"點擊上傳過程圖"},on:{cutDown:t.cutDown1}}),t._v(" "),a("img",{staticStyle:{"margin-top":"20px"},attrs:{src:t.imgUrl2,width:"200px",height:"200px",alt:"過程圖"}}),t._v(" "),a("div",{staticStyle:{display:"flex","margin-top":"10px"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"過程圖說明"},model:{value:t.training.imgDoingDes,callback:function(e){t.$set(t.training,"imgDoingDes",e)},expression:"training.imgDoingDes"}})],1)],1)]),t._v(" "),a("div",[a("div",{staticStyle:{"margin-top":"10px","text-align":"center"}},[a("ImgCutter",{attrs:{rate:"1:1",label:"點擊上傳完成圖"},on:{cutDown:t.cutDown2}}),t._v(" "),a("img",{staticStyle:{"margin-top":"20px"},attrs:{src:t.imgUrl3,width:"200px",height:"200px",alt:"完成圖"}}),t._v(" "),a("div",{staticStyle:{display:"flex","margin-top":"10px"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"完成圖說明"},model:{value:t.training.imgEndDes,callback:function(e){t.$set(t.training,"imgEndDes",e)},expression:"training.imgEndDes"}})],1)],1)])]),t._v(" "),a("div"),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.uploadIssueInfo}},[t._v("确 定")])],1)])],1)},staticRenderFns:[]};var U=a("C7Lr")($,O,!1,function(t){a("CCwu")},"data-v-3e543138",null);e.default=U.exports},"b9Z+":function(t,e,a){"use strict";e.a=function(t){return new n.a(function(e,a){o.a.post(r.a+l.g,t).then(function(t){console.log(t),e(t)}).catch(function(t){a(t),console.log(t)})})},e.b=function(t){return new n.a(function(e,a){o.a.post(r.a+l.h,t).then(function(t){console.log(t),e(t)}).catch(function(t){a(t),console.log(t)})})},e.c=function(t,e,a){return new n.a(function(i,n){o.a.get(r.a+l.i+"?limit="+t+"&skip="+(e-1)*t+"&dateArray="+a).then(function(t){i(t)}).catch(function(t){n(t),console.log(t)})})};var i=a("rVsN"),n=a.n(i),l=a("T452"),r=a("xjP8"),o=a("vLgD")}});
//# sourceMappingURL=1.7d01764433f7ded2812d.js.map